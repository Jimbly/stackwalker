(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";var called_once=false;window.onload=function(){if(called_once){return}called_once=true;require("./glov/bootstrap.js");require("./main.js").main()};


},{"./glov/bootstrap.js":2,"./main.js":5}],2:[function(require,module,exports){
"use strict";require("./polyfill.js");var debug=document.getElementById("debug");window.onerror=function(e,file,line,col,errorobj){var msg=e+"\n  at "+file+"("+line+":"+col+")";if(errorobj&&errorobj.stack){msg=""+errorobj.stack;if(errorobj.message){if(msg.indexOf(errorobj.message)===-1){msg=errorobj.message+"\n"+msg}}var origin=document.location.origin||"";if(origin){if(origin.slice(-1)!=="/"){origin+="/"}msg=msg.split(origin).join("")}msg=msg.replace(/\[\d+\]</g,"").replace(/<?\/<?/g,"/").replace(/\n([^ ])/g,"\n  $1")}var show=true;if(window.glov_error_report){show=window.glov_error_report(msg,file,line,col)}if(show){debug.innerText=msg+"\n\nPlease report this error to the developer, and then reload this page."}};window.debugmsg=function(msg,clear){if(clear){debug.innerText=msg}else{debug.innerText+=msg+"\n"}};


},{"./polyfill.js":4}],3:[function(require,module,exports){
"use strict";exports.get=get;exports.set=set;exports.setJSON=setJSON;exports.getJSON=getJSON;exports.clearAll=clearAll;exports.exportAll=exportAll;exports.importAll=importAll;exports.storage_prefix="demo";var lsd=function(){try{localStorage.test="test";return localStorage}catch(e){return{}}}();function get(key){key=exports.storage_prefix+"_"+key;var ret=lsd[key];if(ret==="undefined"){ret=undefined}return ret}function set(key,value){key=exports.storage_prefix+"_"+key;if(value===undefined||value===null){delete lsd[key]}else{lsd[key]=value}}function setJSON(key,value){set(key,JSON.stringify(value))}function getJSON(key,def){var value=get(key);if(value===undefined){return def}try{return JSON.parse(value)}catch(e){}return def}function clearAll(key_prefix){var prefix=new RegExp("^"+exports.storage_prefix+"_"+(key_prefix||""),"u");for(var key in lsd){if(key.match(prefix)){delete lsd[key]}}}function exportAll(){var obj={};var prefix=new RegExp("^"+exports.storage_prefix+"_(.*)","u");for(var key in lsd){var m=key.match(prefix);if(m){var v=lsd[key];if(v&&v!=="undefined"){obj[m[1]]=v}}}return JSON.stringify(obj)}function importAll(serialized){var obj=JSON.parse(serialized);clearAll();for(var key in obj){set(key,obj[key])}}


},{}],4:[function(require,module,exports){
"use strict";var typedarrays=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array];if(!Uint8Array.prototype.slice){typedarrays.forEach(function(ArrayType){Object.defineProperty(ArrayType.prototype,"slice",{value:function value(begin,end){if(end===undefined){end=this.length}if(end<0){end=this.length-end}begin=begin||0;if(begin>=this.length){begin=this.length-1}if(end>this.length){end=this.length}if(end<begin){end=begin}var len=end-begin;var ret=new ArrayType(len);for(var ii=begin;ii<end;++ii){ret[ii]=this[ii]}return ret}})})}function cmpDefault(a,b){return a-b}var replacements={join:function join(delim){return Array.prototype.join.call(this,delim)},fill:function fill(value,begin,end){if(end===undefined){end=this.length}for(var ii=begin||0;ii<end;++ii){this[ii]=value}return this},sort:function sort(cmp){Array.prototype.sort.call(this,cmp||cmpDefault)}};var _loop=function _loop(key){if(!Uint8Array.prototype[key]){typedarrays.forEach(function(ArrayType){Object.defineProperty(ArrayType.prototype,key,{value:replacements[key]})})}};for(var key in replacements){_loop(key)}if(!String.prototype.endsWith){Object.defineProperty(String.prototype,"endsWith",{value:function value(test){return this.slice(-test.length)===test}});Object.defineProperty(String.prototype,"startsWith",{value:function value(test){return this.slice(0,test.length)===test}})}


},{}],5:[function(require,module,exports){
"use strict";exports.main=main;var local_storage=require("./glov/local_storage.js");local_storage.storage_prefix="stackwalker";var querystring=require("query-string");var stack_mapper=require("stack-mapper");var error_report_regex=/^([^ ]+) \[([^\]]+)] "POST ([^"?]+)?([^"]+)" START "([^"]+)" "([^"]+)"$/;var fileline_regex1=/(.)([^(/:]+)\((\d+):(\d+)\)$/;var fileline_regex2=/(?:at ([^(]+) \(.*\/)?([^(/:]+):(\d+)(?::(\d+))?\)$/;function prettyFileLine(a){return(a.fn||"")+" ("+a.filename+":"+a.line+":"+a.column+")"}function preparse(text){var lines=text.split("\n");var ret=[];for(var ii=0;ii<lines.length;++ii){var line=lines[ii];var m=line.match(error_report_regex);if(!m){ret.push(line);continue}var search=m[4];var useragent=m[6];var query=querystring.parse(search);if(query.url){ret.push("");ret.push("User URL="+query.url+", UA="+useragent)}var header=[];if(query.cidx&&query.cidx!=="1"){header.push("CIDX="+query.cidx)}if(query.ver){header.push("ver="+query.ver)}if(header.length){ret.push(header.join(", "))}if(query.file){ret.push(prettyFileLine({filename:query.file.match(/[^/]+$/)[0],line:query.line,column:query.col}))}ret=ret.concat(query.msg.split("\n"))}return ret.join("\n")}function parseStack(text){text=preparse(text);var lines=text.split("\n");lines=lines.map(function(line){var m=line.match(fileline_regex1)||line.match(fileline_regex2);if(m){return{fn:m[1],filename:m[2],line:m[3],column:m[4]?Number(m[4])-1:undefined,tooltip:line}}return{err:line,tooltip:line}});return lines}function main(){var upload=document.getElementById("upload");var upload_status=document.getElementById("upload_status");var stack=document.getElementById("stack");var frames_bundle=document.getElementById("frames_bundle");var frames_source=document.getElementById("frames_source");var sourcecode=document.getElementById("sourcecode");var source_pre=document.getElementById("source_pre");var source_line=document.getElementById("source_line");var source_post=document.getElementById("source_post");var stack_data;var sourcemap_data;var stackmapper;function toOptions(list){return list.map(function(a){var str=a.err!==undefined?a.err:prettyFileLine(a);return"<option"+(a.err?" disabled":"")+(""+(a.tooltip?' title="'+a.tooltip.replace(/"/g,"&quot;")+'"':""))+(">"+str+"</option>")}).join("\n")}var mapped_stack;function update(){var stack_frames=parseStack(stack_data);frames_bundle.innerHTML=toOptions(stack_frames);mapped_stack=null;if(!stackmapper){frames_source.innerHTML=toOptions([{err:"Missing sourcemap"}]);return}var line_mapping={};var to_process=[];for(var ii=0;ii<stack_frames.length;++ii){var elem=stack_frames[ii];if(elem.filename){line_mapping[ii]=to_process.length;to_process.push(elem)}}var out=stackmapper.map(to_process);var out_lines=[];mapped_stack=[];for(var _ii=0;_ii<stack_frames.length;++_ii){if(line_mapping[_ii]===undefined){mapped_stack.push(null);out_lines.push({err:""})}else{mapped_stack.push(out[line_mapping[_ii]]);out_lines.push(out[line_mapping[_ii]])}}frames_source.innerHTML=toOptions(out_lines)}function updateFocus(){var idx=frames_bundle.selectedIndex;var lineinfo=mapped_stack&&mapped_stack[idx];if(!sourcemap_data){source_pre.textContent="No sourcemap loaded";source_line.textContent=source_post.textContent="";return}if(!lineinfo){source_pre.textContent="No source selected";source_line.textContent=source_post.textContent="";return}var _sourcemap_data=sourcemap_data,sources=_sourcemap_data.sources,sourcesContent=_sourcemap_data.sourcesContent;var filename=lineinfo.filename,line=lineinfo.line;var found=-1;for(var ii=0;ii<sources.length;++ii){if(sources[ii].endsWith(filename)){found=ii}}if(found===-1||!sourcesContent[found]){source_pre.textContent="Could not find "+filename+" in sourcemap.sources";source_line.textContent=source_post.textContent="";return}var lines=sourcesContent[found].split("\n");source_pre.textContent=lines.slice(0,line-1).join("\n");source_line.textContent=lines[line-1];source_post.textContent=lines.slice(line,lines.length).join("\n");source_line.scrollIntoView(true);var st=sourcecode.scrollTop;source_line.scrollIntoView(false);st+=sourcecode.scrollTop;sourcecode.scrollTop=Math.round(st/2)}upload.addEventListener("change",function(ev){var file_to_load=upload.files[0];var reader=new FileReader;local_storage.set("sourcemap",undefined);sourcemap_data=null;stackmapper=null;reader.onload=function(loaded_event){var text=loaded_event.target.result;try{sourcemap_data=JSON.parse(text)}catch(e){upload_status.textContent="Status: Error parsing Sourcemap";throw e}if(sourcemap_data&&sourcemap_data.version===3){upload_status.textContent="Status: Sourcemap loaded";stackmapper=stack_mapper(sourcemap_data)}else{upload_status.textContent="Status: Error parsing Sourcemap (expected version: 3)"}update()};reader.readAsText(file_to_load,"UTF-8")});function onStackChange(ev){stack_data=ev.target.value;local_storage.set("stack",stack_data);update()}stack.addEventListener("change",onStackChange);stack.addEventListener("input",onStackChange);stack.value=stack_data=local_storage.get("stack")||"";function onFramesChange(ev){var idx=ev.target.selectedIndex;if(frames_bundle.selectedIndex!==idx){frames_bundle.selectedIndex=idx}if(frames_source.selectedIndex!==idx){frames_source.selectedIndex=idx}updateFocus()}frames_bundle.addEventListener("change",onFramesChange);frames_source.addEventListener("change",onFramesChange);if(sourcemap_data&&sourcemap_data.version===3){upload_status.textContent="Status: Sourcemap loaded from local storage"}var scroll_locked_source=0;var scroll_locked_bundle=0;frames_source.addEventListener("scroll",function(){if(Date.now()<scroll_locked_source){return}scroll_locked_bundle=Date.now()+400;frames_bundle.scrollTop=frames_source.scrollTop});frames_bundle.addEventListener("scroll",function(){if(Date.now()<scroll_locked_bundle){return}scroll_locked_source=Date.now()+400;frames_source.scrollTop=frames_bundle.scrollTop});update()}


},{"./glov/local_storage.js":3,"query-string":undefined,"stack-mapper":undefined}]},{},[1])

//# sourceMappingURL=app.bundle.js.map
